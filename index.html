<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CAP Class A Blues Uniform Builder</title>
  600px900px;
    }
    .layer { position: absolute; }
    label, select, button {
      display: block; margin: 0.5rem 0; width: 100%;
    }
    select, button { padding: 0.3rem; }
    .hidden-assets { display: none; }
  </style>
</head>
<body>
  <header>
    <h1>CAP Class A Blues Uniform Builder</h1>
  </header>
  <main>
    <section id="controls">
      <label for="ribbonSelect">Ribbons</label>
      <select id="ribbonSelect"></select>
      <button id="addRibbon">Add Ribbon</button>
      <button id="clearRibbons">Clear Ribbons</button>

      <label for="deviceSelect">Devices</label>
      <select id="deviceSelect"></select>
      <button id="addDevice">Add Device</button>

      <label for="badgeSelect">Badges</label>
      <select id="badgeSelect"></select>
      <button id="addBadge">Add Badge</button>

      <label for="rankSelect">Rank Insignia</label>
      <select id="rankSelect"></select>
      <button id="addRank">Add Rank</button>

      <button id="addNameplate">Add Nameplate</button>
      <button id="addUSInsignia">Add U.S. Collar Insignia</button>
      <button id="addCAPInsignia">Add CAP Collar Insignia</button>
      <label for="jacketSelect">Jacket</label>
      <select id="jacketSelect">
        <option value="male">Male</option>
        <option value="female">Female</option>
      </select>
      <button id="changeJacket">Apply Jacket</button>
      <button id="downloadImage">Download Image</button>
    </section>
    <section id="preview">
      <div id="uniformCanvas"></div>
    </section>
  </main>

  <div class="hidden-assets" id="assets">
    <img id="jacket-male" src="images/base/jacket_male.png" style="display:none;">
    <img id="jacket-female" src="images/base/jacket_female.png" style="display:none;">
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script>
    const ribbonSelect = document.getElementById("ribbonSelect");
    const badgeSelect = document.getElementById("badgeSelect");
    const rankSelect = document.getElementById("rankSelect");
    const deviceSelect = document.getElementById("deviceSelect");
    const uniformCanvas = document.getElementById("uniformCanvas");

    let currentGender = "male";
    const selectedRibbons = [];

    const ribbonList = [
      "afa_award", "afsa_award", "air_search_and_rescue_ribbon", "armstrong_achievment",
      "afsa_award", "badges", "bronze_medal_of_valor", "cadet_advisory_council_ribbon",
      "cadet_recruiter_ribbon", "cadet_special_activity_ribbon", "cap_achievement_award",
      "commander_commendation_award", "community_service_ribbon", "crisis_ribbon",
      "curry_achievment", "disaster_relief_ribbon", "distinguished_service_award",
      "dolittle_achievement", "earhart_award", "eaker_award", "encampment_ribbon",
      "exceptional_service_award", "goddard_achievement", "hap_arnold_achievement",
      "homeland_security_ribbon", "iace_ribbon", "lifesaving_award", "lindbergh_achievement",
      "mary_feik_achievement", "meritorious_service_award", "mitchell_award",
      "national_cadet_competition_ribbon", "national_color_guard_competition_ribbon",
      "national_commander_unit_citation_award", "red_service_ribbon", "rickenbacker_achievement",
      "search_find_ribbon", "silver_medal_of_valor", "spaatz_award", "unit_citation_award",
      "vfw_nco_award", "vfw_officer_award", "wright_brothers_award"
    ];

    const badgeList = [
      "aviation_badge", "gtm_badge", "cyber_badge", "chaplain_badge",
      "medical_badge", "communications_badge", "finance_badge", "safety_badge"
    ];

    const rankList = [
      "c_ab", "c_amn", "c_a1c", "c_sra", "c_ssgt", "c_tsgt", "c_msgt", "c_smsgt", "c_cmsgt",
      "c_2dlt", "c_1stlt", "c_capt", "c_maj", "c_ltcol", "c_col"
    ];

    const deviceList = [
      "1_Bronze_Star_Device", "1_Silver_Star_Device", "2_Bronze_Star_Device",
      "2_Silver_Star_Device", "3_Gold_Star_Device", "4_Gold_Star_Device"
    ];

    function loadOptions(select, list, category) {
      list.forEach(name => {
        const option = document.createElement("option");
        option.value = name;
        option.textContent = name.replace(/_/g, " ").replace(/\b\w/g, c => c.toUpperCase());
        select.appendChild(option);

        const img = document.createElement("img");
        img.id = `${category}-${name}`;
        img.src = `images/${category}/${name}.png`;
        img.style.display = "none";
        document.getElementById("assets").appendChild(img);
      });
    }

    // Remaining script unchanged ...

    loadOptions(ribbonSelect, ribbonList, "ribbons");
    loadOptions(badgeSelect, badgeList, "badges");
    loadOptions(rankSelect, rankList, "ranks");
    loadOptions(deviceSelect, deviceList, "devices");

    applyJacket("male");
  </script>
</body>
</html>
